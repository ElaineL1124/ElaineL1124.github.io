(this["webpackJsonpall-in-one"]=this["webpackJsonpall-in-one"]||[]).push([[0],{791:function(e,t){var n=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,r=/^0o[0-7]+$/i,a=/^(?:0|[1-9]\d*)$/,o=parseInt,c=Object.prototype.toString,l=Math.ceil,d=Math.max;function u(e,t,n){var s=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var r=Array(i);++s<i;)r[s]=e[s+t];return r}function p(e,t,n){if(!h(n))return!1;var s=typeof t;return!!("number"==s?function(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!function(e){var t=h(e)?c.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}(e)}(n)&&function(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||a.test(e))&&e>-1&&e%1==0&&e<t}(t,n.length):"string"==s&&t in n)&&function(e,t){return e===t||e!==e&&t!==t}(n[t],e)}function h(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=function(e,t,a){t=(a?p(e,t,a):void 0===t)?1:d(function(e){var t=function(e){if(!e)return 0===e?e:0;if((e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==c.call(e)}(e))return NaN;if(h(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=h(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(n,"");var a=i.test(e);return a||r.test(e)?o(e.slice(2),a?2:8):s.test(e)?NaN:+e}(e))===1/0||e===-1/0){return 17976931348623157e292*(e<0?-1:1)}return e===e?e:0}(e),a=t%1;return t===t?a?t-a:t:0}(t),0);var m=e?e.length:0;if(!m||t<1)return[];for(var b=0,v=0,f=Array(l(m/t));b<m;)f[v++]=u(e,b,b+=t);return f}},855:function(e,t,n){"use strict";n.r(t);var s=n(123),i=n.n(s),r=n(225),a=n(6),o=n(140),c=n(66),l=n.n(c),d=n(34),u=n(130),p=n(321),h=n(38),m=n(13),b=n(81);const v=function(e){let t=e.section,n=e.xapiStatus,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{verb:Object(b.d)(n)?u.i.progressed:u.i.mastered,object:Object(p.c)(t,s),result:Object(p.b)({score:t.score})}};var f=n(4),S=n(92),x=n(167),g=n(61),E=e=>{let t=e.question;const n=t.answers.filter(e=>t.response.indexOf(e.id)>=0).map(e=>e.id).join(u.h.comma),s=t.type===m.j?t.correctAnswerId:t.answers.filter(e=>e.isCorrect).map(e=>e.id).join(u.h.comma),i=e=>t.type===m.j||t.type===m.f?{[Object(g.c)()]:Object(x.g)(e.originalImage)}:Object(g.a)(e.text);return{response:n,correctResponsesPattern:s,interactionType:u.f.choice,extraActivityDefinition:{choices:t.answers.map(e=>({id:e.id,description:i(e)}))}}},y=n(138);var O=e=>{let t=e.question,n=e.questionContent;const s=t.response,i=t.answerGroups,r=s.data,a=void 0===r?(e=>e.reduce((e,t)=>{let n=t.id;return Object(f.a)({[n]:""},e)},{}))(i):r,o=Object.keys(a).map(e=>"".concat(a[e]).concat(u.h.dot).concat(e)).join(u.h.comma),c=i.map(e=>e.answers.filter(e=>e.isCorrect).map(t=>"".concat(t.text).concat(u.h.dot).concat(e.id)).join(u.h.comma)).join(u.h.comma),l=Object(d.a)(n,1)[0],p=void 0===l?{value:""}:l;return{response:o,correctResponsesPattern:c,interactionType:u.f.fillIn,extensions:{[u.d.content]:Object(y.e)(p.value)}}},j=e=>({response:e.question.response.answeredText,omitScore:!0,interactionType:u.f.other}),L=e=>{let t=e.question;return{response:t.response.map(e=>"".concat(e.id).concat(u.h.dot).concat(e.isCorrect)).join(u.h.comma),correctResponsesPattern:t.answers.map(e=>"".concat(e.id).concat(u.h.dot).concat(e.isCorrect)).join(u.h.comma),interactionType:u.f.choice,extraActivityDefinition:{choices:t.answers.map(e=>({id:e.id,description:Object(g.a)(e.text)}))}}},w=e=>{let t=e.question,n=e.isXapiPackageMode;return{response:t.response.map(e=>e.id).join(u.h.comma),correctResponsesPattern:t.answers.map(e=>e.id).join(u.h.comma),interactionType:n?u.f.sequencing:u.f.choice,extraActivityDefinition:{choices:t.answers.map(e=>({id:e.id,description:Object(g.a)(e.text)}))}}},P=e=>{let t=e.question;const n=e=>e.map((e,t)=>({id:t.toString(),description:Object(g.a)(e)})),s=t.answers.map(e=>e.key),i=t.answers.map(e=>e.value).filter((e,t,n)=>n.indexOf(e)===t),r=t.answers.map(e=>"".concat(s.indexOf(e.key)).concat(u.h.dot).concat(i.indexOf(e.value))).join(u.h.comma);return{response:s.map((e,n)=>{const s=t.response.find(t=>t.key===e);let r="";return s&&s.shownSelectedValue&&(r=i.indexOf(s.shownSelectedValue)),"".concat(n).concat(u.h.dot).concat(r)}).join(u.h.comma),correctResponsesPattern:r,interactionType:u.f.matching,extraActivityDefinition:{source:n(s),target:n(i)}}};var A=e=>{let t=e.question;const n=t.dropspots.map(e=>e.text).join(u.h.comma),s=t.dropspots.map(e=>"(".concat(e.x,",").concat(e.y,")")).join(u.h.comma);return{response:t.dropspots.map(e=>{const n=t.response.find(t=>t.id===e.id);if(!n)return"(-1,-1)";const s=n.items.length&&n.items[0];if(!s)return"(-1,-1)";const i=t.dropspots.find(e=>e.id===s.id);return"(".concat(i.x,",").concat(i.y,")")}).join(u.h.comma),correctResponsesPattern:s,interactionType:u.f.other,extensions:{[u.d.imageUrl]:Object(x.g)(t.originalBackground),[u.d.answerTexts]:n}}},H=e=>{let t=e.question;return{response:t.response.map(e=>"(".concat(e.x,",").concat(e.y,")")).join(u.h.comma),correctResponsesPattern:t.spots.map(e=>e.map(e=>"(".concat(e.x,",").concat(e.y,")")).join(u.h.dot)).join(u.h.comma),interactionType:u.f.other,extensions:{[u.d.imageUrl]:Object(x.g)(t.originalBackground)}}};const C=(e,t)=>{let n=Object(d.a)(e,3),s=n[0],i=n[1],r=n[2];return N(s,i,t,function(e){switch(e.type){case m.i:case m.e:case m.j:case m.f:return E;case m.b:return O;case m.g:return j;case m.k:return L;case m.h:return w;case m.l:return P;case m.a:return A;case m.c:return H;default:throw new Error("Question type ".concat(e.type," is not supported"))}}(s)({question:s,questionContent:r,isXapiPackageMode:t}))};function N(e,t,n,s){const i=s.response,a=s.correctResponsesPattern,o=s.interactionType,c=s.extraActivityDefinition,d=s.omitScore,h=s.extensions,m=s.verb,b=function(e,t,n){return r.a.extendContext(new l.a.Context({contextActivities:new l.a.ContextActivities({parent:[Object(p.c)(t,n)]}),extensions:{[u.d.surveyMode]:e.hasOwnProperty("isSurvey")&&e.isSurvey,[u.d.questionType]:e.type}}),n)}(e,t,n);b.extensions=Object.assign(b.extensions,h);let v=Object(f.a)({name:Object(g.a)(e.title),type:u.a.interaction,interactionType:o},a&&{correctResponsesPattern:e.isSurvey?[]:[a]});return v=Object.assign(v,c),{context:b,verb:m||u.i.answered,object:new l.a.Activity({id:Object(S.d)(t.id,e.id,n),definition:new l.a.ActivityDefinition(v)}),result:Object(p.b)({score:e.score,omitScore:d,response:i})}}const R=(e,t)=>{let n=Object(d.a)(e,2);return N(n[0],n[1],t,{interactionType:u.f.other,verb:u.i.experienced})},T={[h.b.PASSED]:u.i.passed,[h.b.FAILED]:u.i.failed,[h.b.IN_PROGRESS]:u.i.progressed},U=(e,t)=>(Object(d.a)(e,1)[0].type===m.d?R:C)(e,t),_=e=>e&&u.i.hasOwnProperty(e)?{verb:u.i[e]}:{verb:u.i.started},I=()=>({verb:u.i.launched}),D=e=>e&&u.i.hasOwnProperty(e)?{verb:u.i[e]}:{verb:u.i.completed},X=e=>{let t=e.course;return{verb:u.i.completed,result:Object(p.b)({score:t.score})}},z=(e,t)=>{let n=e.course,s=e.timeSpent,i=e.xapiStatus;const r={score:n.score,duration:s};return i!==h.b.IN_PROGRESS&&t&&(r.completion=!0,r.success=i===h.b.PASSED),{verb:T[i],result:Object(p.b)(r)}},q=e=>{const t=e.statementsData,n=e.state,s=e.isSubmitOnce,i=e.isXapiPackageMode,r=e.shouldSendCompletedStatement,a=e.omitSectionStatement,o=((e,t)=>{let n=[];return e&&(n=[X({course:t.course})]),n})(r,n);if(s){return[...((e,t)=>{const n=Object(d.a)(e,3),s=n[0],i=n[1],r=n[2];return[...s.map(e=>U(e,t)),...i.map(e=>v(e,t)),z(r,t)]})(t,i),...o]}return[...((e,t,n)=>e.map(e=>{let s=e.section,i=e.questionData,r=e.course;return[s&&!n?v(s,t):[],i?U(i,t):[],z(r,t)]}))(t,i,a).flat(2),...o]},k=e=>{let t=e.statementsData,n=e.state,s=e.isSubmitOnce,i=void 0!==s&&s,r=e.isXapiPackageMode,a=void 0!==r&&r,o=e.shouldSendCompletedStatement,c=void 0!==o&&o,l=e.omitSectionStatement;return q({statementsData:t,state:n,isSubmitOnce:i,isXapiPackageMode:a,shouldSendCompletedStatement:c,omitSectionStatement:void 0!==l&&l})},M=e=>{let t=e.score,n=e.response;return{verb:u.i.evaluated,result:Object(p.b)({score:t,response:n})}};var F=new class{constructor(){this.courseLaunched=void 0,this.courseStarted=void 0,this.informationContentExperienced=void 0,this.questionAnswered=void 0,this.overallCourseProgressed=void 0,this.courseCompleted=void 0,this.courseEvaluated=void 0,this.listStatement=void 0,this.listStatement=[{name:"courseLaunched",instance:I},{name:"courseStarted",instance:_},{name:"informationContentExperienced",instance:R},{name:"questionAnswered",instance:C},{name:"overallCourseProgressed",instance:k},{name:"courseCompleted",instance:D},{name:"courseEvaluated",instance:M}],this.listStatement.forEach(e=>{this[e.name]=function(){const t=[e.instance(...arguments)].flat();return t.map(e=>new l.a.Statement(e))}})}},V=e=>{console.error("xApi error: [ ".concat(B(e)," ]"))};function $(e){console.error("xApi error: [ ".concat(B(e)," ]"))}function B(e){return e?e.code&&e.mesg?"code: ".concat(e.code,", message: ").concat(e.mesg):e.toString():"undefined error"}class G extends o.a{constructor(e){let t=e.sendStatement,n=e.shouldHandlerErrors;super(),this.handlers=void 0,this.sendStatement=void 0,this.shouldHandlerErrors=void 0,this.handlers=[],this.sendStatement=t,this.shouldHandlerErrors=n}createHandler(e){return async t=>{await this.handle(e,t)}}async handle(e,t){try{const n=F[e](t);await this.sendStatement(n)}catch(n){if(!this.shouldHandlerErrors)throw n;V(n)}}}var Q=n(52),J=n(791),W=n.n(J);var K=class{constructor(){this.statements=void 0,this.statements=[]}push(e){this.statements.push(...[e].flat())}shift(){const e=this.statements;return this.statements=[],e}};let Y=!0;var Z=new class{constructor(){this.settings=void 0,this.promises=void 0,this.xapiLmsPromises=void 0,this.lrsStatementStorage=void 0,this.xapiLmsStatementsStorage=void 0}initialize(e){this.settings=e,this.promises=[],this.lrsStatementStorage=new K}initializeXapiLms(e){this.settings=e,this.xapiLmsPromises=[],this.xapiLmsStatementsStorage=new K}sendLrsStatements(e){let t=e;return r.a.isDefaultLrs(this.settings.xApi)||(t=this.getAllowedStatements(e,this.settings.xApi.allowedVerbs),t.length)?(this.lrsStatementStorage.push(t),this.sendStorageStatements(this.lrsStatementStorage,this.promises,r.a.lrs),Promise.all(this.promises)):null}sendNpsStatement(e){this.doSend(r.a.nps.sendStatements.bind(r.a.nps),e)}sendLxpStatement(e){this.doSend(r.a.lxp.sendStatements.bind(r.a.lxp),e)}sendXapiLmsStatements(e){const t=this.getAllowedStatements(e,this.settings.xApi.lmsAllowedVerbs);return t.length?(this.xapiLmsStatementsStorage.push(t),this.sendStorageStatements(this.xapiLmsStatementsStorage,this.xapiLmsPromises,r.a.xapiLms),Promise.all(this.xapiLmsPromises)):null}getAllowedStatements(e,t){return e.filter(e=>t.includes(e.verb.display["en-US"]))}sendStorageStatements(e,t,n){const s=e.shift();if(0!==s.length){const e=W()(s,10).map(e=>this.doSend(n.sendStatements.bind(n),e));t.push(e)}}doSend(e,t){return new Promise((n,s)=>{e(t,e=>{if(e){const t=e.find(e=>null!==e.err);t?s(t.err):(!Y&&a.a.emit(a.b.APP_ONLINE),Y=!0,n())}})}).catch(()=>{setTimeout(()=>{Y&&a.a.emit(a.b.APP_OFFLINE_OR_SERVER_ERROR),Y=!1,this.doSend(e,t)},Q.a)})}};class ee extends G{constructor(){super({sendStatement:Z.sendLrsStatements.bind(Z),shouldHandlerErrors:!0})}initialize(e){let t=e.isScoringOfContentPagesAllowed;this.handlers=[{event:a.b.COURSE_SUBMIT,instance:this.createHandler("overallCourseProgressed")},{event:a.b.COURSE_STARTED,instance:this.createHandler("courseLaunched")},{event:a.b.QUESTION_ANSWERED,instance:this.createHandler("overallCourseProgressed")}],t&&this.handlers.push({event:a.b.INFORMATION_CONTENT_EXPERIENCED,instance:this.createHandler("overallCourseProgressed")})}}class te extends G{constructor(){super({sendStatement:Z.sendNpsStatement.bind(Z)})}initialize(){this.handlers=[{event:a.b.COURSE_EVALUATED,instance:this.createHandler("courseEvaluated")}]}}class ne extends G{constructor(){super({sendStatement:Z.sendLxpStatement.bind(Z)})}initialize(e){this.handlers=Object.keys(e).map(e=>{if(u.c.hasOwnProperty(e)){const t=u.c[e],n=u.e[t];return{event:t,instance:this.createHandler(n)}}return null})}}class se extends G{constructor(){super({sendStatement:Z.sendXapiLmsStatements.bind(Z),shouldHandlerErrors:!0})}initialize(e){let t=e.isScoringOfContentPagesAllowed,n=e.shouldSendStatementsForContentPages;this.handlers=[{event:a.b.COURSE_SUBMIT_XAPI_LMS,instance:this.createHandler("overallCourseProgressed")},{event:a.b.COURSE_STARTED,instance:this.createHandler("courseLaunched")},{event:a.b.QUESTION_ANSWERED_XAPI_LMS,instance:this.createHandler("overallCourseProgressed")}],(t||n)&&this.handlers.push({event:a.b.INFORMATION_CONTENT_EXPERIENCED_XAPI_LMS,instance:this.createHandler("overallCourseProgressed")})}}t.default=new class{constructor(){this.lrsEventHandler=void 0,this.npsEventHandler=void 0,this.lxpEventHandler=void 0,this.xapiLmsEventHandler=void 0,this.settings=void 0,this.defaultLrsUrl=void 0,this.defaultNpsUrl=void 0,this.defaultLxpUrl=void 0,this.lrsEventHandler=new ee,this.npsEventHandler=new te,this.lxpEventHandler=new ne,this.xapiLmsEventHandler=new se}subscribeLrs(){try{r.a.initializeLrs(this.settings.xApi,this.defaultLrsUrl)}catch(e){this.unsubscribeLrs(),V(e)}this.lrsEventHandler.on()}subscribeNps(){try{r.a.initializeNps(this.defaultNpsUrl)}catch(e){this.unsubscribeNps(),$(e)}this.npsEventHandler.on()}subscribeLxp(e){try{r.a.initializeLxp(this.defaultLxpUrl,e)}catch(t){this.unsubscribeLxp(),$(t)}this.lxpEventHandler.on()}subscribeXapiLms(){try{r.a.initializeXapiLms()}catch(e){this.unsubscribeXapiLms(),V(e)}this.xapiLmsEventHandler.on()}unsubscribeLrs(){this.lrsEventHandler.off()}unsubscribeNps(){this.npsEventHandler.off()}unsubscribeLxp(){this.lxpEventHandler.off()}unsubscribeXapiLms(){this.xapiLmsEventHandler.off()}unsubscribeAll(){this.unsubscribeLrs(),this.unsubscribeNps(),this.unsubscribeLxp(),this.unsubscribeXapiLms()}initializeXapiLms(e){let t=e.settings;this.xapiLmsEventHandler.initialize(t),Z.initializeXapiLms(t)}initialize(e){var t;let n=e.settings,s=e.defaultLrsUrl,a=e.defaultNpsUrl,o=e.defaultLxpUrl,c=e.course,l=e.actor;this.settings=n,this.defaultLrsUrl=s,this.defaultNpsUrl=a,this.defaultLxpUrl=o,this.lrsEventHandler.initialize(n),this.npsEventHandler.initialize(),i()(null===(t=n.lxp)||void 0===t?void 0:t.xApiVerbs)||this.lxpEventHandler.initialize(n.lxp.xApiVerbs),r.a.initialize({course:c,actor:l}),Z.initialize(n)}}}}]);