(this["webpackJsonpall-in-one"]=this["webpackJsonpall-in-one"]||[]).push([[9],{769:function(e,t,n){"use strict";n.r(t),n.d(t,"commentsList",(function(){return c})),n.d(t,"commentAdded",(function(){return l})),n.d(t,"commentResolved",(function(){return s})),n.d(t,"commentUnResolved",(function(){return d})),n.d(t,"commentDeleted",(function(){return u})),n.d(t,"commentRestored",(function(){return m})),n.d(t,"replyAdded",(function(){return p})),n.d(t,"replyDeleted",(function(){return f})),n.d(t,"replyRestored",(function(){return b})),n.d(t,"commentResolvedAck",(function(){return h})),n.d(t,"commentDeletedAck",(function(){return v})),n.d(t,"replyDeletedAck",(function(){return g}));var i=n(160),a=n(65),o=n(22),r=n(82);const c=e=>t=>{t({type:r.a.COMMENTS_LIST,payload:{comments:e}})},l=e=>t=>{Object(i.b)(e,Object(o.e)(a.a.getState()))&&t({type:r.a.COMMENT_ADDED,payload:{comment:e}})},s=e=>t=>{t({type:r.a.COMMENT_RESOLVED,payload:e})},d=e=>t=>{t({type:r.a.COMMENT_UNRESOLVED,payload:e})},u=e=>t=>{t({type:r.a.COMMENT_DELETED,payload:e})},m=e=>t=>{t({type:r.a.COMMENT_RESTORED,payload:e})},p=e=>t=>{t({type:r.a.COMMENT_REPLY_ADDED,payload:e})},f=e=>t=>{t({type:r.a.COMMENT_REPLY_DELETED,payload:e})},b=e=>t=>{t({type:r.a.COMMENT_REPLY_RESTORED,payload:e})},h=e=>t=>{t({type:r.a.COMMENT_RESOLVED_ACK,payload:e})},v=e=>t=>{t({type:r.a.COMMENT_DELETED_ACK,payload:e})},g=e=>t=>{t({type:r.a.COMMENT_REPLY_DELETED_ACK,payload:e})}},847:function(e,t,n){e.exports=n.p+"static/media/comment.c2441ff4.svg"},856:function(e,t,n){"use strict";n.r(t);var i={};n.r(i),n.d(i,"init",(function(){return T})),n.d(i,"trackEvent",(function(){return k}));var a=n(0),o=n.n(a),r=n(20),c=n(8),l=n(329),s=n(2),d=n(28),u=n(73),m=n(84),p=n.n(m),f=n(18);const b=Object(f.createSelector)([e=>e.user.email,e=>e.comments,(e,t)=>t],(e,t,n)=>{let i;return i=n?t.filter(e=>{var t,i;let a=e.context,o=n.property;return a&&[u.v.QUESTION,u.v.INFORMATION_CONTENT].includes(a.type)&&!a.property&&(o=void 0),a&&a.id===n.id&&a.type===n.type&&a.property===o&&(null===(t=a.ref)||void 0===t?void 0:t.id)===(null===(i=n.ref)||void 0===i?void 0:i.id)}):t.filter(e=>!e.context),i=i.filter(t=>{var n,i,a;return(t.createdBy.isReviewer||t.createdBy.isAnonymous)&&!(t.isDeleted&&(!t.deletedBy||(null===(n=t.deletedBy)||void 0===n?void 0:n.isReviewer)||(null===(i=t.deletedSeenEmails)||void 0===i?void 0:i.includes(e)))||t.isResolved&&(!t.resolvedBy||(null===(a=t.resolvedSeenEmails)||void 0===a?void 0:a.includes(e))))}).map(t=>{const n=p()(t);return n.replies=n.replies.filter(t=>{var n,i;return!(t.isDeleted&&(!t.deletedBy||(null===(n=t.deletedBy)||void 0===n?void 0:n.isReviewer)||(null===(i=t.deletedSeenEmails)||void 0===i?void 0:i.includes(e))))}),n}),i});var h=n(77),v=n(29),g=n(45),x=n(105),E=n(771),O=n(4),y=n(3),w=n(229);class j{constructor(){}static getInstance(){return j.instance||(j.instance=new j),j.instance}async init(e){const t=(await n.e(8).then(n.bind(null,860))).Analytics,i=await n.e(12).then(n.bind(null,853));j.analytics=t({plugins:[i.default({writeKey:e})]}),j.timestamp=Date.now()}trackEvent(e,t,n){const i={},a={Amplitude:{session_id:j.timestamp}};t&&(i.category=t),n&&Object.assign(i,n);try{j.analytics.track(e,i,{integrations:a})}catch(o){throw w.a.log(o),o}}}j.analytics=void 0,j.instance=void 0,j.timestamp=void 0;var C=j.getInstance();const T=()=>async(e,t)=>{const n=Object(y.a)(t());await C.init(n)},k=(e,t)=>async(n,i)=>{const a=Object(y.a)(i());await C.init(a),C.trackEvent(e,t)};var R=n(139),D=n(769),S=n(6),M=n(34),I=n(10),A=n(1),_=n(40),L=n(5),N=n(53),H=n(186);function V(){const e=Object(A.a)([""]);return V=function(){return e},e}function B(){const e=Object(A.a)([""]);return B=function(){return e},e}function P(){const e=Object(A.a)(["\n  ",";\n  ",";\n  font-size: 10px;\n  font-weight: 600;\n  color: #5e6571;\n  cursor: pointer;\n  margin-left: 16px;\n  padding: 0;\n  text-decoration: underline;\n\n  &:hover,\n  &:focus {\n    text-decoration: none;\n  }\n"]);return P=function(){return e},e}function z(){const e=Object(A.a)(["\n  ",";\n  ",";\n  position: relative;\n  color: #fff;\n  cursor: pointer;\n  box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.1);\n  ",";\n\n  background: linear-gradient(90deg, #2cbd9a 0%, #65c86d 100%);\n  border-radius: 48px;\n  display: flex;\n  padding: 7px 12px;\n  align-items: flex-start;\n  gap: 10px;\n  font-size: 10px;\n  font-weight: 600;\n  line-height: 10px;\n\n  &:not(:disabled):hover,\n  &:not(:disabled):focus {\n    background: linear-gradient(180deg, rgba(54, 62, 78, 0.1), rgba(54, 62, 78, 0.1)),\n      linear-gradient(90deg, #2cbd9a 0%, #65c86d 100%);\n  }\n\n  &:disabled:before {\n    background-color: rgba(255, 255, 255, 0.5);\n    content: '';\n    cursor: not-allowed;\n    height: 100%;\n    left: 0;\n    position: absolute;\n    top: 0;\n    width: 100%;\n    border-radius: 48px;\n  }\n"]);return z=function(){return e},e}function K(){const e=Object(A.a)(["\n  align-self: flex-end;\n  display: flex;\n  align-items: center;\n  justify-content: flex-start;\n  margin-top: ",";\n  margin-left: 24px;\n  margin-bottom: 24px;\n"]);return K=function(){return e},e}function F(){const e=Object(A.a)(["\n  background: ",";\n  display: flex;\n  justify-content: space-between;\n  flex-wrap: wrap;\n  width: 100%;\n  box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.1);\n  border-radius: 6px;\n"]);return F=function(){return e},e}function U(){const e=Object(A.a)(["\n  ",";\n  width: ","px;\n  margin: -5px -7px -7px;\n"]);return U=function(){return e},e}const Y=s.default.form(U(),H.c,e=>e.width||444),Z=s.default.div(F(),e=>e.theme.colors.contentBodyColor),W=s.default.div(K(),e=>"".concat(e.marTop||12,"px")),q=s.default.button(z(),N.a,H.c,Object(_.f)(.3)),G=s.default.button(P(),N.a,H.c),J=Object(s.default)(q).attrs(()=>({"data-test":"review-form-submit-button"}))(B()),Q=Object(s.default)(G)(V());function X(){const e=Object(A.a)(["\n  ",";\n  ",";\n  font-weight: 600;\n  line-height: 130%;\n  padding: 0;\n  cursor: pointer;\n  display: inline-block;\n  background: #fff;\n\n  &:before {\n    ",";\n  }\n"]);return X=function(){return e},e}function $(){const e=Object(A.a)(["\n  position: absolute;\n  bottom: 0;\n  right: 0;\n\n  &:before {\n    content: '';\n    display: inline-block;\n    width: 56px;\n    height: 16px;\n    margin-bottom: -5px;\n    background: linear-gradient(270deg, #fff -4.12%, #fff -4.11%, rgba(249, 253, 255, 0.2) 99.95%);\n  }\n"]);return $=function(){return e},e}function ee(){const e=Object(A.a)([""]);return ee=function(){return e},e}function te(){const e=Object(A.a)(["\n  overflow: hidden;\n  vertical-align: bottom;\n  margin: 0;\n  word-break: break-word;\n  max-height: 48px;\n"]);return te=function(){return e},e}function ne(){const e=Object(A.a)(["\n  ",";\n  text-align: left;\n  position: relative;\n  width: 100%;\n"]);return ne=function(){return e},e}const ie=s.default.div(ne(),H.a),ae=s.default.p(te()),oe=s.default.span.attrs({"data-test":"review-comment-text"})(ee()),re=s.default.div($()),ce=s.default.button(X(),N.a,H.a,e=>e.isExpanded?'content: "\\00a0"':'content: "...\\00a0"');var le=n(166);function se(){const e=Object(A.a)(["\n  padding: 12px 0 0 32px;\n  text-align: left;\n"]);return se=function(){return e},e}function de(){const e=Object(A.a)(["\n  margin: 12px 0 0 32px;\n"]);return de=function(){return e},e}function ue(){const e=Object(A.a)(["\n  font-size: 10px;\n  line-height: 10px;\n"]);return ue=function(){return e},e}function me(){const e=Object(A.a)([""]);return me=function(){return e},e}function pe(){const e=Object(A.a)(["\n  ",";\n  cursor: pointer;\n  display: inline-block;\n  font-size: 10px;\n  font-weight: 600;\n  line-height: 13px;\n"]);return pe=function(){return e},e}function fe(){const e=Object(A.a)(["\n  width: 14px;\n"]);return fe=function(){return e},e}function be(){const e=Object(A.a)(["\n  display: flex;\n  gap: 4px;\n  height: 13px;\n"]);return be=function(){return e},e}function he(){const e=Object(A.a)([""]);return he=function(){return e},e}function ve(){const e=Object(A.a)(["\n  padding: 4px;\n  border-radius: 100%;\n  display: inline-flex;\n  cursor: pointer;\n  font-size: 3px;\n\n  &:hover {\n    color: white;\n    background-color: #b0bdc8;\n    transition: background-color 0.5s;\n  }\n"]);return ve=function(){return e},e}function ge(){const e=Object(A.a)(["\n  display: flex;\n  align-items: flex-start;\n  justify-content: flex-start;\n  height: 60px;\n\n  &:hover {\n    "," {\n      opacity: 1;\n    }\n  }\n"]);return ge=function(){return e},e}function xe(){const e=Object(A.a)(["\n  width: max-content;\n  padding: 4px;\n  opacity: 0;\n\n  transition: opacity 0.5s;\n"]);return xe=function(){return e},e}function Ee(){const e=Object(A.a)(["\n  font-weight: normal;\n\n  div:first-child {\n    background: transparent;\n    color: #4caf50;\n    text-decoration: underline;\n    box-shadow: none;\n\n    &:hover {\n      background: #e1f2e1;\n    }\n  }\n"]);return Ee=function(){return e},e}function Oe(){const e=Object(A.a)(["\n  border-top: 1px solid #ebeced;\n  margin-top: 12px;\n  padding-top: 8px;\n  font-size: 10px;\n  color: #5e6571;\n\n  > b {\n    font-weight: 600;\n  }\n"]);return Oe=function(){return e},e}function ye(){const e=Object(A.a)(["\n  ",";\n  ",";\n  padding: 8px 24px;\n  border-radius: 48px;\n  background: #f85d67;\n  height: 28px;\n  outline: none;\n  border: none;\n  cursor: pointer;\n  color: #ffffff;\n  font-weight: 600;\n  line-height: 1;\n\n  &:hover {\n    background: #f74a55;\n  }\n"]);return ye=function(){return e},e}function we(){const e=Object(A.a)(["\n  ",";\n  ",";\n  font-weight: 600;\n  line-height: 130%;\n  color: #5e6571;\n  text-decoration: underline;\n  cursor: pointer;\n  background: none;\n  outline: none;\n  border: none;\n\n  &:hover {\n    text-decoration: none;\n  }\n"]);return we=function(){return e},e}function je(){const e=Object(A.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 24px;\n"]);return je=function(){return e},e}function Ce(){const e=Object(A.a)(["\n  margin: 0;\n  width: 100%;\n  gap: 12px;\n  justify-content: flex-end;\n  padding-right: 20px;\n  font-weight: 600;\n"]);return Ce=function(){return e},e}function Te(){const e=Object(A.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-bottom: 12px;\n  ",";\n  font-weight: 600;\n"]);return Te=function(){return e},e}function ke(){const e=Object(A.a)(["\n  padding: 8px 9px;\n"]);return ke=function(){return e},e}function Re(){const e=Object(A.a)(["\n  background: rgba(255, 255, 255, 0.95);\n  margin: 8px 0 8px 32px;\n  width: 100%;\n"]);return Re=function(){return e},e}function De(){const e=Object(A.a)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 15px 0 11px;\n  margin: 9px 12px;\n  border-radius: 4px;\n  border: 1px solid #ebeced;\n"]);return De=function(){return e},e}function Se(){const e=Object(A.a)(["\n  border-right: ",";\n  padding-right: 6px;\n  cursor: pointer;\n"]);return Se=function(){return e},e}function Me(){const e=Object(A.a)(["\n  display: flex;\n  align-items: center;\n  position: absolute;\n  left: 280px;\n  top: 18px;\n  border: 0;\n  background: transparent;\n  cursor: pointer;\n"]);return Me=function(){return e},e}function Ie(){const e=Object(A.a)(["\n  color: #868b95;\n"]);return Ie=function(){return e},e}function Ae(){const e=Object(A.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: flex-start;\n  gap: 6px;\n\n  ",";\n  font-size: 10px;\n  font-weight: 600;\n  line-height: 13px;\n"]);return Ae=function(){return e},e}function _e(){const e=Object(A.a)(["\n          height: auto;\n          padding-bottom: 12px;\n          border-bottom: 1px solid #f5f5f6;\n        "]);return _e=function(){return e},e}function Le(){const e=Object(A.a)(["\n  cursor: text;\n  height: 14px;\n\n  ","\n"]);return Le=function(){return e},e}function Ne(){const e=Object(A.a)(["\n  width: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  cursor: pointer;\n"]);return Ne=function(){return e},e}function He(){const e=Object(A.a)(["\n  ",";\n  font-size: 10px;\n  line-height: 13px;\n  color: #9b9fa6;\n"]);return He=function(){return e},e}function Ve(){const e=Object(A.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n  cursor: pointer;\n"]);return Ve=function(){return e},e}function Be(){const e=Object(A.a)(["\n  height: 100%;\n  width: 100%;\n\n  ",";\n  font-style: italic;\n  text-align: left;\n"]);return Be=function(){return e},e}function Pe(){const e=Object(A.a)(["\n  display: flex;\n  align-items: flex-start;\n  justify-content: space-between;\n  gap: 16px;\n\n  width: 100%;\n  padding: 20px 24px;\n  border-top: 1px solid #f5f5f6;\n  color: #363e4e;\n\n  .icon-close-review {\n    display: block;\n    position: sticky;\n    right: 12px;\n    margin-top: 11px;\n    cursor: pointer;\n    width: 10px;\n    height: 10px;\n  }\n"]);return Pe=function(){return e},e}function ze(){const e=Object(A.a)(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: 3px;\n  flex: 1;\n  overflow: hidden;\n\n  .icon {\n    display: flex;\n    justify-content: flex-start;\n    align-items: center;\n  }\n"]);return ze=function(){return e},e}function Ke(){const e=Object(A.a)(["\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  justify-content: flex-start;\n  gap: 16px;\n  width: 100%;\n\n  &:hover {\n    "," {\n      opacity: 1;\n    }\n  }\n"]);return Ke=function(){return e},e}function Fe(){const e=Object(A.a)(["\n  display: flex;\n  gap: 12px;\n  flex: 1;\n  position: relative;\n"]);return Fe=function(){return e},e}function Ue(){const e=Object(A.a)(["\n  width: 100%;\n  margin-bottom: 12px;\n"]);return Ue=function(){return e},e}function Ye(){const e=Object(A.a)(["\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  justify-content: center;\n  gap: 8px;\n\n  width: 100%;\n"]);return Ye=function(){return e},e}function Ze(){const e=Object(A.a)(["\n  display: flex;\n  justify-content: end;\n  margin-top: 16px;\n"]);return Ze=function(){return e},e}function We(){const e=Object(A.a)(["\n  margin-left: 32px;\n  padding: 16px 0 12px 0;\n  border-bottom: 1px solid #f5f5f6;\n\n  &:hover {\n    "," {\n      opacity: 1;\n    }\n  }\n"]);return We=function(){return e},e}function qe(){const e=Object(A.a)(["\n  text-align: left;\n  font-weight: 600;\n  font-size: 12px;\n  color: #4a5160;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n"]);return qe=function(){return e},e}function Ge(){const e=Object(A.a)(["\n          "," {\n            padding-right: 20px;\n          }\n        "]);return Ge=function(){return e},e}function Je(){const e=Object(A.a)(["\n  max-height: 528px;\n  overflow: auto;\n  ","\n\n  &::-webkit-scrollbar {\n    width: 4px;\n  }\n\n  ","\n"]);return Je=function(){return e},e}function Qe(){const e=Object(A.a)(["\n          background: #f9fdff;\n\n          "," {\n            background: #f9fdff;\n          }\n        "]);return Qe=function(){return e},e}function Xe(){const e=Object(A.a)(["\n  display: flex;\n  align-items: stretch;\n  flex-wrap: wrap;\n  width: 100%;\n  padding: 20px 24px;\n  border-top: 1px solid #f5f5f6;\n\n  &:hover {\n    background: #f9fdff;\n\n    "," {\n      background: #f9fdff;\n    }\n  }\n\n  ","\n"]);return Xe=function(){return e},e}function $e(){const e=Object(A.a)([""]);return $e=function(){return e},e}function et(){const e=Object(A.a)(["\n  opacity: 0;\n  cursor: pointer;\n  height: 14px;\n  border: 0;\n  background: transparent;\n\n  &:focus-visible {\n    outline: 1px solid black;\n    opacity: 1;\n  }\n\n  &:hover,\n  &:focus-visible {\n    svg > path {\n      fill: #f85d67;\n    }\n  }\n"]);return et=function(){return e},e}function tt(){const e=Object(A.a)(["\n  width: 100%;\n"]);return tt=function(){return e},e}function nt(){const e=Object(A.a)(["\n  padding-left: 20px;\n  position: relative;\n"]);return nt=function(){return e},e}function it(){const e=Object(A.a)(["\n  position: absolute;\n  left: 0;\n"]);return it=function(){return e},e}function at(){const e=Object(A.a)(["\n  display: flex;\n  align-items: center;\n  gap: 16px;\n\n  height: 28px;\n  padding: 0 24px 12px 24px;\n\n  ",";\n  ",";\n  font-weight: 600;\n  line-height: 13px;\n  cursor: pointer;\n"]);return at=function(){return e},e}function ot(){const e=Object(A.a)(["\n  margin: 16px 0 0 32px;\n  width: 100%;\n  overflow: hidden;\n"]);return ot=function(){return e},e}function rt(){const e=Object(A.a)(["\n      & {\n        background-color: ",";\n        box-shadow: inset 0 2px 0 0 ",";\n        border: solid 1px ",";\n        ",";\n      }\n    "]);return rt=function(){return e},e}function ct(){const e=Object(A.a)(["\n  ",";\n  display: block;\n  min-height: 74px;\n  width: 100%;\n  padding: 12px;\n  margin-top: 8px;\n  resize: none;\n  border: 1px solid #469dd5;\n  border-radius: 4px;\n  outline: none;\n  white-space: pre-wrap;\n  word-wrap: break-word;\n  overflow-wrap: break-word;\n\n  &:hover {\n    border-color: #76b6e0;\n  }\n\n  &:focus {\n    outline: none;\n    border-color: #469dd5;\n    box-shadow: inset 0 1px 3px 0 rgba(70, 157, 213, 0.3);\n  }\n\n  ",";\n"]);return ct=function(){return e},e}function lt(){const e=Object(A.a)(["\n  ",";\n  font-size: 10px;\n  font-weight: 600;\n  line-height: 13px;\n  display: inline-block;\n"]);return lt=function(){return e},e}function st(){const e=Object(A.a)(["\n  font-size: 10px;\n\n  height: 32px;\n  width: 32px;\n  min-width: 32px;\n\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  color: #5cac67;\n  background: ",";\n  background-size: cover;\n  background-repeat: no-repeat;\n  background-position: center;\n\n  border-radius: 100%;\n  border: ",";\n"]);return st=function(){return e},e}function dt(){const e=Object(A.a)([""]);return dt=function(){return e},e}function ut(){const e=Object(A.a)(["\n  margin: 20px 24px 0;\n  text-align: left;\n"]);return ut=function(){return e},e}function mt(){const e=Object(A.a)(["\n  position: absolute;\n  left: 21px;\n  top: 21px;\n\n  height: 16px;\n  width: 16px;\n"]);return mt=function(){return e},e}function pt(){const e=Object(A.a)(["\n  color: #363e4e;\n  cursor: pointer;\n  margin-right: 4px;\n  ","\n"]);return pt=function(){return e},e}function ft(){const e=Object(A.a)(["\n  display: inline-block;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n"]);return ft=function(){return e},e}function bt(){const e=Object(A.a)(["\n  ",";\n  font-weight: 600;\n  font-size: 14px;\n  line-height: 18px;\n  padding: 16px 74px 16px 24px;\n  margin-bottom: 12px;\n  text-align: left;\n  color: #363e4e;\n  border-bottom: 1px solid #f5f5f6;\n  display: flex;\n  gap: 8px;\n"]);return bt=function(){return e},e}function ht(){const e=Object(A.a)(["\n  width: 100%;\n"]);return ht=function(){return e},e}function vt(){const e=Object(A.a)(["\n  &:focus-visible {\n    outline: 2px solid black;\n  }\n"]);return vt=function(){return e},e}const gt=Object(s.css)(vt()),xt=s.default.div(ht()),Et=s.default.h3(bt(),H.a),Ot=s.default.span(ft()),yt=Object(s.default)(r.k)(pt(),e=>4===e.size?"top: 4px;":"top: 2px;"),wt=s.default.div(mt()),jt=s.default.div(ut()),Ct=s.default.div(dt()),Tt=s.default.div.attrs(e=>{let t=e.children;return{"data-test":"review-avatar",children:e.avatarUrl?null:t}})(st(),e=>e.avatarUrl?"url(".concat(e.avatarUrl,")"):"#F0FAF0",e=>e.avatarUrl?"unset":"1px solid #B2E3B6"),kt=s.default.label(lt(),H.a),Rt=s.default.textarea.attrs(e=>({"aria-label":e.ariaLabel,"data-test":"comment-text-area"}))(ct(),H.a,e=>!e.validComment&&Object(s.css)(rt(),Object(L.a)(e.theme.colors.textColor,.02),Object(L.a)(e.theme.colors.incorrectColor,.06),e.theme.colors.incorrectColor,_.a)),Dt=Object(s.default)(jt)(ot()),St=s.default.div(at(),gt,H.a),Mt=s.default.div(it()),It=s.default.div(nt()),At=s.default.div(tt()),_t=s.default.button(et()),Lt=Object(s.default)(_t)($e()),Nt=s.default.div.attrs(e=>({"data-test":"comment-item",id:e.commentId}))(Xe(),ce,e=>e.isActiveComment?Object(s.css)(Qe(),ce):""),Ht=s.default.div(Je(),Object(le.a)(),e=>e.hasScroll?Object(s.css)(Ge(),Nt):""),Vt=s.default.div.attrs({"data-test":"review-commenter-name"})(qe()),Bt=s.default.div(We(),Lt),Pt=s.default.div(Ze()),zt=s.default.div(Ye()),Kt=s.default.div(Ue()),Ft=s.default.div(Fe()),Ut=s.default.div(Ke(),_t),Yt=s.default.div(ze()),Zt=s.default.div.attrs({"data-test":"review-closed-comment-overlay"})(Pe()),Wt=s.default.div(Be(),H.a),qt=s.default.div(Ve()),Gt=s.default.div.attrs({"data-test":"review-comment-date"})(He(),H.a),Jt=s.default.div(Ne()),Qt=Object(s.default)(Jt)(Le(),e=>e.isExpanded?Object(s.css)(_e()):""),Xt=s.default.div(Ae(),H.a),$t=s.default.span(Ie()),en=s.default.button(Me()),tn=Object(s.default)("div")(Se(),e=>e.isExpanded?"none":"1px solid #ebeced"),nn=s.default.div(De()),an=s.default.div(Re()),on=Object(s.default)(nn)(ke()),rn=s.default.div(Te(),H.a),cn=(Object(s.default)(rn)(Ce()),s.default.div(je())),ln=Object(s.default)("button")(we(),H.a,gt),sn=Object(s.default)("button")(ye(),H.a,gt),dn=Object(s.default)("div")(Oe()),un=(Object(s.default)(cn)(Ee()),s.default.div(xe())),mn=(s.default.div(ge(),un),s.default.div(ve()),s.default.div.attrs({"data-test":"review-form-submit-button"})(he())),pn=s.default.div(be()),fn=s.default.div(fe()),bn=Object(s.default)(mn).attrs({"data-test":"review-form-reply-button"})(pe(),H.a),hn=Object(s.default)(q).attrs({"data-test":"review-form-reply-button"})(me()),vn=Object(s.default)(ln).attrs({"data-test":"review-reply-cancel-button"})(ue()),gn=s.default.div(de()),xn=s.default.div(se());var En=n(47),On=n(305),yn=n(322),wn=n(196);var jn=e=>{const t=e.text,n=e.expand,i=void 0!==n&&n,r=e.onMinimized,l=void 0===r?()=>{}:r,s=Object(a.useState)(i),d=Object(M.a)(s,2),u=d[0],m=d[1],p=Object(a.useState)(!1),f=Object(M.a)(p,2),b=f[0],h=f[1],v=Object(a.useState)("48px"),g=Object(M.a)(v,2),x=g[0],E=g[1],O=Object(a.useRef)(null),y=()=>{var e,t;O.current&&h((null===(e=O.current)||void 0===e?void 0:e.scrollHeight)>(null===(t=O.current)||void 0===t?void 0:t.clientHeight))};Object(a.useEffect)(()=>{setTimeout(y,1)},[]),Object(a.useEffect)(()=>{var e;E(i?"".concat((null===O||void 0===O?void 0:null===(e=O.current)||void 0===e?void 0:e.scrollHeight)+16,"px"):"48px"),m(i)},[i]);const w=e=>{var t;(e.preventDefault(),e.nativeEvent.stopImmediatePropagation(),u)?(l(),E("48px")):E("".concat((null===O||void 0===O?void 0:null===(t=O.current)||void 0===t?void 0:t.scrollHeight)+16,"px"));m(!u)};return o.a.createElement(ie,null,o.a.createElement(ae,{style:{maxHeight:x},ref:O},o.a.createElement(oe,{dangerouslySetInnerHTML:{__html:t}}),b&&o.a.createElement(ce,{onClick:w,isExpanded:u},Object(c.a)("[less]"))),b&&!u&&o.a.createElement(re,null,o.a.createElement(ce,{onClick:w,isExpanded:u},Object(c.a)("[more]"))))},Cn=n(117);var Tn=()=>o.a.createElement(Cn.a,{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",version:"1.1",xmlns:"http://www.w3.org/2000/svg",role:"img",arialabel:"trash icon"},o.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.66233 1.75526C6.01711 1.40048 6.49828 1.20117 7.00001 1.20117C7.50174 1.20117 7.98292 1.40048 8.3377 1.75526C8.6872 2.10476 8.88583 2.57694 8.89165 3.07059H5.10837C5.1142 2.57694 5.31282 2.10476 5.66233 1.75526ZM4.58147 4.07059C4.59034 4.07106 4.59926 4.0713 4.60824 4.0713C4.61722 4.0713 4.62615 4.07106 4.63501 4.07059H9.36502C9.37388 4.07106 9.3828 4.0713 9.39178 4.0713C9.40076 4.0713 9.40969 4.07106 9.41855 4.07059H10.8052V11.3438C10.8052 11.465 10.7571 11.5811 10.6714 11.6668C10.5858 11.7524 10.4696 11.8006 10.3485 11.8006H3.65154C3.53042 11.8006 3.41425 11.7524 3.3286 11.6668C3.24295 11.5811 3.19483 11.465 3.19483 11.3438V4.07059H4.58147ZM4.10833 3.07059C4.11419 2.31172 4.41818 1.58519 4.95522 1.04815C5.49753 0.50584 6.23307 0.201172 7.00001 0.201172C7.76696 0.201172 8.50249 0.50584 9.0448 1.04815C9.58184 1.58519 9.88584 2.31172 9.8917 3.07059H11.3052H12.7403C13.0164 3.07059 13.2403 3.29445 13.2403 3.57059C13.2403 3.84673 13.0164 4.07059 12.7403 4.07059H11.8052V11.3438C11.8052 11.7302 11.6517 12.1007 11.3785 12.3739C11.1054 12.6471 10.7348 12.8006 10.3485 12.8006H3.65154C3.2652 12.8006 2.89468 12.6471 2.62149 12.3739C2.34831 12.1007 2.19483 11.7302 2.19483 11.3438V4.07059H1.25977C0.983623 4.07059 0.759766 3.84673 0.759766 3.57059C0.759766 3.29445 0.983623 3.07059 1.25977 3.07059H2.69483H4.10833ZM5.56495 4.98518C5.84109 4.98518 6.06495 5.20904 6.06495 5.48518V10.0893C6.06495 10.3655 5.84109 10.5893 5.56495 10.5893C5.2888 10.5893 5.06495 10.3655 5.06495 10.0893V5.48518C5.06495 5.20904 5.2888 4.98518 5.56495 4.98518ZM8.93509 5.48518C8.93509 5.20904 8.71123 4.98518 8.43508 4.98518C8.15894 4.98518 7.93508 5.20904 7.93508 5.48518V10.0893C7.93508 10.3655 8.15894 10.5893 8.43508 10.5893C8.71123 10.5893 8.93509 10.3655 8.93509 10.0893V5.48518Z",fill:"#363E4E"}));var kn=()=>o.a.createElement(Cn.a,{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",version:"1.1",xmlns:"http://www.w3.org/2000/svg",role:"img",arialabel:"people icon"},o.a.createElement("circle",{cx:"8",cy:"8",r:"8",fill:"white"}),o.a.createElement("path",{d:"M8.00067 6.18295C8.00067 6.6293 7.82336 7.05736 7.50775 7.37298C7.19213 7.68859 6.76407 7.8659 6.31772 7.8659C5.87138 7.8659 5.44331 7.68859 5.1277 7.37298C4.81208 7.05736 4.63477 6.6293 4.63477 6.18295C4.63477 5.7366 4.81208 5.30854 5.1277 4.99293C5.44331 4.67731 5.87138 4.5 6.31772 4.5C6.76407 4.5 7.19213 4.67731 7.50775 4.99293C7.82336 5.30854 8.00067 5.7366 8.00067 6.18295ZM10.3568 7.8659C10.7139 7.8659 11.0563 7.72405 11.3088 7.47156C11.5613 7.21907 11.7032 6.87662 11.7032 6.51954C11.7032 6.16246 11.5613 5.82001 11.3088 5.56752C11.0563 5.31503 10.7139 5.17318 10.3568 5.17318C9.99973 5.17318 9.65728 5.31503 9.40478 5.56752C9.15229 5.82001 9.01044 6.16246 9.01044 6.51954C9.01044 6.87662 9.15229 7.21907 9.40478 7.47156C9.65728 7.72405 9.99973 7.8659 10.3568 7.8659ZM9.68362 9.61213V9.54885C9.68411 9.18463 9.56596 8.83017 9.34703 8.53908H11.5504C12.0054 8.53908 12.375 8.90799 12.375 9.36373C12.375 9.36373 12.375 10.8952 10.3555 10.8952C9.9529 10.8952 9.63044 10.8346 9.37261 10.737C9.53342 10.4424 9.6356 10.1193 9.67353 9.78581C9.67757 9.74408 9.68026 9.7084 9.6816 9.67878L9.68362 9.61213ZM9.01044 9.54885C9.01044 9.28105 8.90406 9.02421 8.71469 8.83484C8.52532 8.64547 8.26848 8.53908 8.00067 8.53908H4.63477C4.36696 8.53908 4.11012 8.64547 3.92076 8.83484C3.73139 9.02421 3.625 9.28105 3.625 9.54885V9.59934C3.625 9.59934 3.625 11.5684 6.31772 11.5684C8.88389 11.5684 9.00438 9.78043 9.01044 9.61213V9.54885Z",fill:"#C3C5CA"}));var Rn=()=>o.a.createElement(Cn.a,{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",version:"1.1",xmlns:"http://www.w3.org/2000/svg",role:"img",arialabel:"conversation icon"},o.a.createElement("circle",{cx:"8",cy:"8",r:"8",fill:"white"}),o.a.createElement("path",{d:"M13 9.5C13 8.11929 11.8807 7 10.5 7C9.11929 7 8 8.11929 8 9.5C8 10.8807 9.11929 12 10.5 12C10.9229 12 11.3218 11.8948 11.6714 11.7091L12.6586 11.9898C12.7044 12.0028 12.753 12.0033 12.7991 11.9913C12.8453 11.9793 12.8874 11.9552 12.9211 11.9215C12.9548 11.8877 12.9789 11.8456 12.9909 11.7995C13.0029 11.7533 13.0023 11.7048 12.9893 11.6589L12.7086 10.672C12.9004 10.3111 13.0005 9.90865 13 9.5Z",fill:"#C3C5CA"}),o.a.createElement("path",{d:"M3.5 7.49967C3.49932 8.08462 3.62739 8.66168 3.87411 9.19021L3.53408 10.3857L3.53403 10.3859C3.49147 10.5357 3.48968 10.6942 3.52885 10.845C3.56802 10.9958 3.64673 11.1333 3.75685 11.2435C3.86697 11.3537 4.0045 11.4325 4.15525 11.4717C4.306 11.511 4.46449 11.5093 4.61436 11.4668L4.61477 11.4667L5.81064 11.1266C6.32459 11.3663 6.89761 11.5 7.5 11.5C9.70914 11.5 11.5 9.70914 11.5 7.5C11.5 5.29086 9.70914 3.5 7.5 3.5C5.29097 3.5 3.50018 5.29068 3.5 7.49967ZM3.5 7.49967C3.5 7.49957 3.5 7.49948 3.5 7.49938L4 7.5H3.5C3.5 7.49989 3.5 7.49978 3.5 7.49967Z",fill:"#C3C5CA",stroke:"white"}),o.a.createElement("circle",{cx:"5.7998",cy:"7.5",r:"0.5",fill:"white"}),o.a.createElement("circle",{cx:"7.5",cy:"7.5",r:"0.5",fill:"white"}),o.a.createElement("circle",{cx:"9.2002",cy:"7.5",r:"0.5",fill:"white"}));var Dn=()=>o.a.createElement(Cn.a,{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",version:"1.1",xmlns:"http://www.w3.org/2000/svg",role:"img",arialabel:"reply icon"},o.a.createElement("path",{d:"M3.2998 10C4.87373 8.65109 5.26088 8.09091 6.7998 8.09091H7.6075V9.72727L10.2998 6.72727L7.6075 4V5.63636H7.06904C4.37673 5.63636 3.83827 8.36364 3.2998 10Z",stroke:"#363E4E",strokeWidth:"0.8",strokeLinecap:"round",strokeLinejoin:"round"}));var Sn=()=>o.a.createElement(Cn.a,{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",version:"1.1",xmlns:"http://www.w3.org/2000/svg",role:"img",arialabel:"plus inside circle icon"},o.a.createElement("g",{clipPath:"url(#clip0_10346_18453)"},o.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.99916 10.5706C8.52389 10.5706 10.5706 8.52389 10.5706 5.99916C10.5706 3.47443 8.52389 1.42773 5.99916 1.42773C3.47443 1.42773 1.42773 3.47443 1.42773 5.99916C1.42773 8.52389 3.47443 10.5706 5.99916 10.5706ZM11.5706 5.99916C11.5706 9.07618 9.07618 11.5706 5.99916 11.5706C2.92215 11.5706 0.427734 9.07618 0.427734 5.99916C0.427734 2.92215 2.92215 0.427734 5.99916 0.427734C9.07618 0.427734 11.5706 2.92215 11.5706 5.99916ZM5.99916 2.92773C6.27531 2.92773 6.49916 3.15159 6.49916 3.42773V5.49916H8.57059C8.84673 5.49916 9.07059 5.72302 9.07059 5.99916C9.07059 6.27531 8.84673 6.49916 8.57059 6.49916H6.49916V8.57059C6.49916 8.84673 6.27531 9.07059 5.99916 9.07059C5.72302 9.07059 5.49916 8.84673 5.49916 8.57059V6.49916H3.42773C3.15159 6.49916 2.92773 6.27531 2.92773 5.99916C2.92773 5.72302 3.15159 5.49916 3.42773 5.49916H5.49916V3.42773C5.49916 3.15159 5.72302 2.92773 5.99916 2.92773Z",fill:"#363E4E"})),o.a.createElement("defs",null,o.a.createElement("clipPath",{id:"clip0_10346_18453"},o.a.createElement("rect",{width:"12",height:"12",fill:"white"}))));const Mn=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{t.forEach(t=>{t&&("function"===typeof t?t(e):t.current=e)})}},In=e=>{const t=e.target;t.style.height="auto",t.style.overflowY="hidden";const n=t.getBoundingClientRect().height,i=Math.min(t.scrollHeight,440);n<i&&(t.style.height="".concat(i+2,"px")),440===i&&(t.style.overflowY="auto")};var An=e=>{const t=Object(a.useRef)(null);return Object(a.useEffect)(()=>{const e=t.current;return e&&e instanceof HTMLElement?(setTimeout(()=>{e.focus({preventScroll:!0})}),e.addEventListener("input",In),()=>{e.removeEventListener("input",In)}):()=>{}},[]),o.a.createElement(Rt,Object.assign({},e,{ref:Mn(e.getRef,t)}))},_n=n(774);var Ln=Object(s.withTheme)(Object(d.b)((function(e,t){return{comments:b(e,t.context),reviewCommentReply:Object(g.a)(e)}}),(function(e){return{moduleActions:Object(v.b)(h,e)}}))(e=>{var t,n;const i=e.layout,l=e.commentText,s=e.replyText,d=e.isValidComment,m=e.onChange,p=e.getRefs,f=e.onSubmit,b=e.getFormActions,h=e.onDelete,v=e.onAcknowledgeDeleted,g=e.onAcknowledgeResolved,x=e.context,E=e.comments,y=void 0===E?[]:E,w=e.name,j=e.avatarUrl,C=e.reviewCommentReply,T=e.moduleActions,k=e.closePopover,R=e.cleanTextInputValue,D=Object(a.useState)(""),S=Object(M.a)(D,2),A=S[0],_=S[1],L=Object(a.useState)(!1),N=Object(M.a)(L,2),H=N[0],V=N[1],B=Object(a.useState)(!y.length),P=Object(M.a)(B,2),z=P[0],K=P[1],F=Object(a.useState)({}),U=Object(M.a)(F,2),Y=U[0],Z=U[1],W=Object(a.useState)({}),q=Object(M.a)(W,2),G=q[0],J=q[1],Q=Object(a.useState)([]),X=Object(M.a)(Q,2),$=X[0],ee=X[1],te=Object(a.useState)([]),ne=Object(M.a)(te,2),ie=ne[0],ae=ne[1],oe=null!==(t=null===(n=yn.CommentContextUtil.getContextTitle(x))||void 0===n?void 0:n.toLowerCase())&&void 0!==t?t:Object(c.a)("content").toLowerCase(),re=Object(c.a)("reviewSpotContextDescription",{contextType:oe}),ce=Object(a.useRef)(null),le=Object(a.useRef)(null),se=Object(a.useState)(!1),de=Object(M.a)(se,2),ue=de[0],me=de[1],pe=Object(a.useState)(!1),fe=Object(M.a)(pe,2),be=fe[0],he=fe[1],ve=Object(a.useRef)(null);Object(a.useEffect)(()=>{if(!document.getElementById("root"))return;const e=e=>{var t;e.key===I.s.ESCAPE&&(null===(t=ve.current)||void 0===t?void 0:t.contains(document.activeElement))&&k()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[]);Object(a.useEffect)(()=>(le.current=new _n.default(e=>{for(const t of e)me(t.target.scrollHeight>t.target.clientHeight)}),ce.current&&le.current.observe(ce.current),()=>{le.current&&le.current.disconnect()}),[y.length]),Object(a.useEffect)(()=>{C&&ge()},[]);const ge=()=>{const e=(null!==C&&void 0!==C?C:{}).commentId;if(!e)return;const t=(e=>{var t;return(null===(t=y.find(t=>t.replies.find(t=>t.id===e)))||void 0===t?void 0:t.id)||""})(e);e&&t&&(Ce(t),setTimeout(()=>{Object(wn.c)(e)},1e3),null===T||void 0===T||T.reviewCommentReply(null))},xe=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=e.target,i=e.shiftKey,a=e.ctrlKey,o=e.metaKey,r=e.altKey,c=e.nativeEvent.code;if(c===I.s.ENTER){if(i&&!a&&!o||r)return;var l;if(e.preventDefault(),t)null===(l=document.getElementById(t))||void 0===l||l.click();else n.parentNode.nextElementSibling.firstChild.click()}},Ee=(e,t)=>{e.nativeEvent.stopImmediatePropagation(),e.preventDefault(),s.trim()&&(_(""),f(e,t))},Oe=e=>{var t,n;return(null===(t=e.createdBy)||void 0===t?void 0:t.isReviewer)||(null===(n=e.createdBy)||void 0===n?void 0:n.isAnonymous)?o.a.createElement(Rn,null):o.a.createElement(kn,null)},ye=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;setTimeout(()=>{const t=document.querySelector(e);t&&t.scrollIntoView({behavior:"smooth",block:"center"})},t)},we=e=>{ye('[data-replies-list-comment-id="'.concat(e,'"]'),400)},je=(e,t)=>{e.nativeEvent.stopImmediatePropagation(),e.preventDefault(),R("reply"),_(t),K(!1),(e=>{ye('[data-reply-input-comment-id="'.concat(e,'"]'),400)})(t),(e=>{var t;return!!(null===(t=y.find(t=>t.id===e))||void 0===t?void 0:t.replies.length)})(t)&&!$[t]?Ce(t,!1):ae([...ie,t])},Ce=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];$[e]=!$[e],$[e]&&ae([...ie,e]),$[e]&&A!==e&&t&&we(e),ee(Object(O.a)({},$))},Te=e=>t=>{t.nativeEvent.stopImmediatePropagation(),je(t,e)},ke=e=>e.createdBy.isReviewer||e.createdBy.isAnonymous,Re=()=>i===u.j.ADD_COMMENT_WITH_HISTORY,De=e=>{e.nativeEvent.stopImmediatePropagation(),_(""),K(!0)},Se=async e=>{if(!H)try{if("comment-text-area"===e.target.id&&!l.trim().length)return void e.preventDefault();V(!0),await f(e),V(!1),[u.j.ADD_COMMENT_WITH_HISTORY,u.j.ADD_COMMENT].includes(i)&&K(!1)}catch(t){V(!1)}},Me=(e,t)=>e.isResolved?o.a.createElement(Zt,{key:e.id},o.a.createElement(Wt,null,o.a.createElement("span",null,!!t?Object(c.a)("[reply resolved by author]"):Object(c.a)("[comment resolved by owner]"))),o.a.createElement(qt,{tabIndex:1,onClick:()=>g(e.id),onKeyDown:t=>{Object(wn.b)(t,()=>g(e.id))}},o.a.createElement(r.k,{name:"close-review",size:10}))):o.a.createElement(Zt,{key:e.id},o.a.createElement(Wt,null,o.a.createElement("span",null,(e=>e?Object(c.a)("[reply deleted by author]"):Object(c.a)("[comment deleted by author]"))(!!t))),o.a.createElement(qt,{tabIndex:1,onClick:()=>v(e.id,null===t||void 0===t?void 0:t.id),onKeyDown:n=>{Object(wn.b)(n,()=>v(e.id,null===t||void 0===t?void 0:t.id))}},o.a.createElement(r.k,{name:"close-review",size:10}))),Ie=e=>o.a.createElement(o.a.Fragment,null,o.a.createElement(Dt,{"data-reply-input-comment-id":e.id,"data-test":"review-reply-container"},o.a.createElement(zt,null,o.a.createElement(Kt,null,o.a.createElement(Ft,null,o.a.createElement(Tt,{avatarUrl:j},Object(En.c)(w)),o.a.createElement(wt,null,o.a.createElement(Rn,null)),o.a.createElement(Yt,null,o.a.createElement(Vt,{title:w},w))))),o.a.createElement(An,{tabIndex:1,getRef:p,ariaLabel:Object(c.a)("[comment area]"),validComment:d,onChange:m,onKeyDown:e=>xe(e,"reply-text-area"),name:"replyText",value:s,placeholder:Object(c.a)("[placeholder reply input]")})),o.a.createElement(gn,null,o.a.createElement(Jt,null,o.a.createElement(Xt,null,o.a.createElement(hn,{id:"reply-text-area",tabIndex:1,disabled:!s.trim().length,onClick:t=>Ee(t,e.id),onKeyDown:t=>{Object(wn.b)(t,()=>Ee(t,e.id))}},Object(c.a)("[reply]")),o.a.createElement(vn,{onClick:e=>(e=>{e.nativeEvent.stopImmediatePropagation(),e.preventDefault(),_(""),R("reply"),he(!be)})(e),tabIndex:1},Object(c.a)("[cancel]")))))),Ae=()=>o.a.createElement(o.a.Fragment,null,o.a.createElement(jt,{"data-test":"review-new-comment-container"},!y.length&&o.a.createElement(kt,{"data-test":"comment-form-title"},Object(c.a)("[leave a comment]")),o.a.createElement(An,{tabIndex:1,getRef:p,ariaLabel:Object(c.a)("[comment area]"),validComment:d,onChange:m,onKeyDown:xe,name:"commentText",value:l,placeholder:Object(c.a)("[placeholder comment input]")})),b(Se,Ke)),_e=e=>o.a.createElement(pn,null,o.a.createElement(fn,{"data-test":"reply-icon"},o.a.createElement(Dn,null)),o.a.createElement(bn,{"data-test":"review-add-new-reply-button",role:"button",tabIndex:1,"aria-label":Object(c.a)("[reply]"),onClick:t=>je(t,e),onKeyDown:t=>{Object(wn.b)(t,()=>je(t,e))}},Object(c.a)("[reply]"))),Le=e=>A===e,Ne=e=>{return Le(e.id)?Ie(e):(t=e.id,o.a.createElement(xn,{"data-test":"review-reply-container",onClick:Te(t)},_e(t)));var t},He=(e,t)=>{e.nativeEvent.stopImmediatePropagation(),he(!be),Z(Object(O.a)({},Y,{[t]:!Y[t]}))},Ve=(e,t)=>{e.nativeEvent.stopImmediatePropagation(),J(Object(O.a)({},G,{[t]:!G[t]}))},Be=e=>new Date(e).toLocaleString("en-us",{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",hour12:!0,minute:"2-digit"}),Pe=e=>e.createdBy&&e.createdBy.fullName||"".concat(e.createdBy.firstName," ").concat(e.createdBy.lastName),ze=e=>Y[e.id]?o.a.createElement(nn,{"data-test":"review-delete-confirmation-popover"},o.a.createElement(rn,null,Object(c.a)("[delete comment question]")),o.a.createElement(cn,null,o.a.createElement(ln,{tabIndex:1,onClick:t=>He(t,e.id)},Object(c.a)("[cancel]")),o.a.createElement(sn,{tabIndex:1,onClick:t=>((e,t)=>{e.nativeEvent.stopImmediatePropagation(),e.preventDefault(),h(t)})(t,e.id)},Object(c.a)("[delete]"))),o.a.createElement(dn,{dangerouslySetInnerHTML:{__html:Object(c.a)("[replies will be removed]")}})):o.a.createElement(Nt,{key:e.id,isActiveComment:$[e.id],commentId:e.id},o.a.createElement(zt,null,o.a.createElement(Kt,null,o.a.createElement(Ft,null,o.a.createElement(Ct,null,o.a.createElement(Tt,{avatarUrl:e.createdBy.avatarUrl,e:!0},Object(En.c)(e.createdBy.fullName||"".concat(e.createdBy.firstName," ").concat(e.createdBy.lastName)))),o.a.createElement(wt,null,Oe(e)),o.a.createElement(Yt,null,o.a.createElement(Vt,{title:Pe(e)},Pe(e)),o.a.createElement(Gt,{title:Be(e.createdOn)},Object(On.a)(new Date(e.createdOn))))))),o.a.createElement(Ut,null,o.a.createElement(jn,{text:e.text,expand:ie.includes(e.id),onMinimized:()=>ae(ie.filter(t=>t!==e.id))}),Re()&&o.a.createElement(Qt,{"data-replies-list-comment-id":e.id,isExpanded:Le(e.id)||$[e.id]},o.a.createElement(Xt,null,!!e.replies.length&&o.a.createElement(tn,{tabIndex:1,"aria-expanded":Le(e.id)||$[e.id],"aria-haspopup":!0,role:"button",onClick:()=>Ce(e.id),onKeyDown:t=>{Object(wn.b)(t,()=>Ce(e.id))},"data-test":"review-comment-reply-count",isExpanded:Le(e.id)||$[e.id]},o.a.createElement(yt,function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e?{name:"chevron-up-v2",size:4}:{name:"chevron-right",size:8}}($[e.id])),(e=>{const t=e.replies.filter(e=>!e.isDeleted&&!e.isResolved).length;if(!t)return null;const n="[".concat(1===t?"one reply":"X replies","]");return Object(c.a)(n,{x:t})})(e)),o.a.createElement("div",null,!Le(e.id)&&!$[e.id]&&_e(e.id))),Re()&&ke(e)&&o.a.createElement(_t,{tabIndex:1,"aria-label":Object(c.a)("[delete comment]"),title:Object(c.a)("[delete comment]"),"data-test":"delete-comment-button",onClick:t=>He(t,e.id)},o.a.createElement(Tn,null)))),Le(e.id)&&!$[e.id]&&Ie(e),$[e.id]&&e.replies&&e.replies.map((t,n)=>t.isDeleted?Me(e,t):Fe(e,t,n)),$[e.id]&&Ne(e)),Ke=e=>{e.nativeEvent.stopImmediatePropagation(),e.preventDefault(),R(),(null===y||void 0===y?void 0:y.length)?K(!1):k()},Fe=(e,t,n)=>G[t.id]?o.a.createElement(an,{key:t.id},o.a.createElement(on,{"data-test":"review-reply-deleted-overlay"},o.a.createElement(rn,{"data-test":"review-reply-deleted-popover-title"},Object(c.a)("[delete reply question]")),o.a.createElement(cn,null,o.a.createElement(ln,{"data-test":"review-reply-deleted-popover-cancel-button",onClick:e=>Ve(e,t.id)},Object(c.a)("[cancel]")),o.a.createElement(sn,{"data-test":"review-reply-deleted-popover-delete-button",onClick:n=>((e,t,n)=>{e.nativeEvent.stopImmediatePropagation(),e.preventDefault(),h(t,n)})(n,e.id,t.id)},Object(c.a)("[delete]"))))):o.a.createElement(At,{key:t.id},o.a.createElement(Bt,{"data-test":"comment-item"},o.a.createElement(zt,null,o.a.createElement(Kt,null,o.a.createElement(Ft,null,o.a.createElement(Tt,{avatarUrl:t.createdBy.avatarUrl},Object(En.c)("".concat(t.createdBy.firstName," ").concat(t.createdBy.lastName))),o.a.createElement(wt,null,Oe(t)),o.a.createElement(Yt,null,o.a.createElement(Vt,{title:Pe(t)},Pe(t)),o.a.createElement(Gt,{title:Be(t.createdOn)},Object(On.a)(new Date(t.createdOn))))))),o.a.createElement(Ut,null,o.a.createElement(jn,{text:t.text})),Re()&&ke(t)&&o.a.createElement(Pt,{onClick:e=>Ve(e,t.id),"data-test":"delete-comment-button"},o.a.createElement(Lt,{tabIndex:1,title:Object(c.a)("[delete reply]")},o.a.createElement(Tn,null))))),Ue=()=>[u.j.ADD_COMMENT_WITH_HISTORY,u.j.ADD_COMMENT].includes(i);return o.a.createElement(xt,{id:"comment-form",role:"dialog","aria-modal":!0,tabIndex:-1,ref:ve},Ue()&&!!(null===y||void 0===y?void 0:y.length)&&o.a.createElement(Et,{"data-test":"comment-form-title"},o.a.createElement(Ot,{title:re},re),o.a.createElement($t,null,"(",y.length,")"),o.a.createElement(en,{tabIndex:1,"aria-label":Object(c.a)("[close popup]"),onClick:k},o.a.createElement(r.k,{name:"close-popup",size:12}))),Ue()&&(y.length?z?Ae():o.a.createElement(St,{"data-test":"review-new-comment-container",role:"button",tabIndex:1,"aria-label":Object(c.a)("[add comment]"),onClick:De,onKeyDown:e=>{Object(wn.b)(e,()=>De(e))}},o.a.createElement(It,{"data-test":"review-add-new-comment-button"},o.a.createElement(Mt,null,o.a.createElement(Sn,null)),Object(c.a)("[add comment]"))):Ae()),Ue()&&!!(null===y||void 0===y?void 0:y.length)&&o.a.createElement(Ht,{ref:ce,hasScroll:ue},null===y||void 0===y?void 0:y.map((e,t)=>e.isResolved||e.isDeleted?Me(e,null):o.a.createElement(a.Fragment,{key:"comment-list-".concat(e.id)},o.a.createElement(At,{key:e.id,isActiveComment:$[e.id]},ze(e))))))})),Nn=n(14),Hn=n(22);class Vn extends a.Component{constructor(e){super(e),this.loginRefs=void 0,this.updateLayout=e=>{this.props.moduleActions.updateReviewLayout(e)},this.beforeSubmitValidation=()=>{const e=!!this.loginRefs.name&&this.loginRefs.name.validity.valid,t=!!this.loginRefs.email&&this.loginRefs.email.validity.valid;this.setState({validationStatusBeforeSubmit:{isNameValid:e,isEmailValid:t}})},this.checkInputValidation=e=>!!e&&(this.setState({validationStatusBeforeSubmit:Object(O.a)({},this.state.validationStatusBeforeSubmit,{[e.target.name]:e.target.validity.valid||!1})}),e.target.validity.valid||!1),this.onChange=e=>{this.setState({[e.target.name]:e.target.value}),["name","email"].includes(e.target.name)&&this.props.userActions.updateUser({[e.target.name]:e.target.value})},this.getRefs=e=>{e&&(this.loginRefs[e.name]=e)},this.validateComment=()=>{const e=this.props,t=e.email,n=e.name,i=this.state,a=i.commentText,o=i.showLoginForm,r=i.validationStatusBeforeSubmit,c=i.requestSending,l=r.isEmailValid&&r.isNameValid;return a.trim()?t&&n?!(o&&!l||c):(this.setState({showLoginForm:!0}),!1):(this.setState({isValidComment:!1}),setTimeout(()=>{this.setState({isValidComment:!0},()=>{this.loginRefs.commentText.focus()})},500),!1)},this.addCommentWithoutAuth=()=>{this.updateLayout(u.j.ADD_COMMENT)},this.submitCommentOrReply=async(e,t)=>{let n;const i=this.props,a=i.context,o=i.name,r=this.state,c=r.commentText,l=r.replyText,s={text:c,createdByName:o};if(s.context=a,this.setState({showSuccessMessage:!1,showErrorMessage:!1}),"reply-text-area"===e.target.id)s.text=l,n=await S.a.emit(S.b.COMMENT_REPLY_SENT,{commentId:t,data:s});else{if(!c)return;this.setState({requestSending:!0}),n=await S.a.emit(S.b.COMMENT_SENT,{data:s})}n[0]===u.y&&this.setState({showSuccessMessage:!0,showErrorMessage:!1,showLoginForm:!1,isValidComment:!0,commentText:"",replyText:"",requestSending:!1}),n[0]===u.d&&this.setState({showErrorMessage:!0,showSuccessMessage:!1,requestSending:!1})},this.getActionHandler=e=>({[u.j.LOGIN_WITH_EMAIL]:()=>{},[u.j.REGISTER_NEW_REVIEWER]:()=>{},[u.j.VERIFICATION_EMAIL_SENT]:this.addCommentWithoutAuth,[u.j.ADD_COMMENT]:this.submitCommentOrReply,[u.j.ADD_COMMENT_WITH_HISTORY]:this.submitCommentOrReply}[e]),this.actionButtonHandler=async(e,t)=>{e.preventDefault();const n=this.props.layout,i=this.getActionHandler(n);if([u.j.ADD_COMMENT,u.j.ADD_COMMENT_WITH_HISTORY,u.j.REGISTER_NEW_REVIEWER,u.j.VERIFICATION_EMAIL_SENT].includes(n)){let t=u.t[n];n===u.j.ADD_COMMENT_WITH_HISTORY&&"reply-text-area"===e.target.id&&(t=u.t.ADD_REPLY),this.props.amplitudeActions.trackEvent(t,u.q)}return i(e,t)},this.deleteComment=async(e,t)=>{t?await S.a.emit(S.b.REPLY_DELETED,{commentId:e,replyId:t}):await S.a.emit(S.b.COMMENT_DELETED,{commentId:e})},this.ackDeleted=async(e,t)=>{t?await S.a.emit(S.b.ACK_REPLY_DELETED,{commentId:e,replyId:t}):await S.a.emit(S.b.ACK_COMMENT_DELETED,{commentId:e})},this.ackResolved=async(e,t)=>{await S.a.emit(S.b.ACK_COMMENT_RESOLVED,{commentId:e})},this.skipToCommentsView=e=>{this.props.isAuthenticatedReviewer&&!(null===e||void 0===e?void 0:e.isAuthenticatedReviewer)&&this.updateLayout(u.j.ADD_COMMENT_WITH_HISTORY)},this.handleKeyDown=e=>t=>{var n,i;((null===(n=t.key)||void 0===n?void 0:n.toLowerCase())===I.s.SPACEBAR.toLowerCase()||(null===(i=t.key)||void 0===i?void 0:i.toLowerCase())===I.s.ENTER.toLowerCase())&&e&&e(t)},this.formActions=(e,t)=>{const n=this.props.layout,i=this.state,o=i.requestSending,r=i.commentText;return a.createElement(W,{verifyPopupShown:n===u.j.ADD_COMMENT,marTop:16},a.createElement(J,{tabIndex:1,disabled:!r.trim().length||o,onClick:e,onKeyDown:this.handleKeyDown(e),id:n===u.j.ADD_COMMENT?"comment-text-area":""},Object(c.a)(u.z[n])),a.createElement(Q,{"data-test":"review-form-cancel-button",tabIndex:1,onClick:t,onKeyDown:this.handleKeyDown(t)},Object(c.a)("[cancel]")))},this.cleanTextInputValue=e=>{e?this.setState({replyText:""}):this.setState({commentText:""})},this.state={requestSending:!1,commentText:"",replyText:"",isValidComment:!0,showSuccessMessage:!1,showErrorMessage:!1,showLoginForm:!1,showResendEmailPopup:!1,linkResent:!1,isEmailRegistered:!1,loginLinkSent:!1,previousEmail:"",previousName:"",validationStatusBeforeSubmit:{isNameValid:!0,isEmailValid:!0},touchedStatus:{name:!1,email:!1}},this.loginRefs={name:"",email:""}}async componentDidMount(){this.skipToCommentsView()}componentDidUpdate(e,t){const n=this.props,i=n.email,a=void 0===i?"":i,o=n.name,r=void 0===o?"":o,c=n.isReviewerLoginLinkSent,l=document.activeElement;c&&!e.isReviewerLoginLinkSent&&this.updateLayout(u.j.ADD_COMMENT),l&&"commentText"!==l.getAttribute("name")&&"replyText"!==l.getAttribute("name")&&this.loginRefs.commentText&&setTimeout(()=>{this.state.isValidComment&&this.loginRefs.commentText.focus()},0),e.name&&!r&&e.email&&!a&&this.setState({requestSending:!1,commentText:"",replyText:"",isValidComment:!0,showSuccessMessage:!1,showErrorMessage:!1,showLoginForm:!1,showResendEmailPopup:!1,linkResent:!1,isEmailRegistered:!1,loginLinkSent:!1,previousEmail:"",previousName:"",validationStatusBeforeSubmit:{isNameValid:!0,isEmailValid:!0},touchedStatus:{name:!1,email:!1}}),this.skipToCommentsView(e)}render(){const e=this.props,t=e.closePopover,n=e.context,i=e.name,o=void 0===i?"":i,r=e.email,c=void 0===r?"":r,l=e.avatarUrl,s=e.layout,d=this.state,m=d.replyText,p=d.commentText,f=d.isValidComment;return a.createElement(Y,{"data-test":"review-form",width:320},a.createElement(Z,{verifyPopupShown:s===u.j.ADD_COMMENT},a.createElement(Ln,{name:o,email:c,avatarUrl:l,getRefs:this.getRefs,commentText:p,replyText:m,isValidComment:f,onChange:this.onChange,onSubmit:this.actionButtonHandler,onDelete:this.deleteComment,onAcknowledgeDeleted:this.ackDeleted,onAcknowledgeResolved:this.ackResolved,closePopover:t,context:n,layout:s,getFormActions:this.formActions,cleanTextInputValue:this.cleanTextInputValue})))}}var Bn=Object(d.b)((function(e){return{layout:Object(g.b)(e),name:Object(Hn.g)(e),email:Object(Hn.e)(e),avatarUrl:Object(Hn.d)(e),isAuthenticatedReviewer:Object(Hn.l)(e),courseId:Object(Nn.i)(e),isReviewerLoginLinkSent:Object(g.j)(e)}}),(function(e){return{userActions:Object(v.b)(R,e),moduleActions:Object(v.b)(h,e),commentActions:Object(v.b)(D,e),amplitudeActions:Object(v.b)(i,e)}}))(Vn),Pn=n(847),zn=n.n(Pn);class Kn extends a.Component{constructor(e){super(e),this.focusReviewSpot=()=>{var e;const t=this.props.context.id||(null===(e=this.props.context.ref)||void 0===e?void 0:e.id),n=document.getElementById("review-spot-".concat(t));n&&n.focus()},this.addOrRemoveInertAtrribute=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=document.getElementById("root");t&&(e?t.removeAttribute("inert"):t.setAttribute("inert",""))},this.toggle=e=>{e&&e.preventDefault(),this.setState(e=>({isExpanded:!e.isExpanded}),()=>{if(this.props.moduleActions.isTooltipExpanded(this.state.isExpanded),!this.state.isExpanded)return this.addOrRemoveInertAtrribute(),void setTimeout(()=>{this.focusReviewSpot()},100);this.state.isExpanded&&(this.addOrRemoveInertAtrribute(!1),setTimeout(()=>{const e=document.getElementById("comment-form");e&&e.focus()},0))})},this.closePopup=()=>{this.setState({isExpanded:!1},()=>{this.props.moduleActions.isTooltipExpanded(this.state.isExpanded)}),this.addOrRemoveInertAtrribute()},this.hideHint=()=>{this.setState({isShownHint:!1})},this.getFontSize=e=>e>=100&&e<1e3?"9px":e>=1e3?"7px":"11px",this.state={isExpanded:!1,isShownHint:!!this.props.hintName}}componentDidMount(){var e,t;const n=this.props,i=n.reviewCommentReply,a=n.context,o=null!==(e=a.id||(null===(t=a.ref)||void 0===t?void 0:t.id))&&void 0!==e?e:"";(null===i||void 0===i?void 0:i.commentId)&&!this.isResponse(i)&&Object(wn.d)(a,i)&&setTimeout(()=>{Object(wn.c)(o),this.toggle()},1e3)}isResponse(e){return e.identifier.includes("res")}render(){var e;const t=this.state.isExpanded,n=this.props,i=n.theme,o=n.context,d=n.hintName,u=n.isVoiceOver,m=n.numberOfComments,p=o.id||(null===(e=o.ref)||void 0===e?void 0:e.id);return a.createElement(E.b,{isVoiceOver:u,isActive:t,id:p},a.createElement(l.a,{position:"bottom",hintElements:Object(c.a)("[add a comment hover over any block]"),hintName:d,isExpanded:this.state.isShownHint,isRtl:null===i||void 0===i?void 0:i.isRtl,onHideHint:this.hideHint},a.createElement(r.y,{shouldShowTooltip:!0,trigger:"manual",open:t,onRequestClose:()=>this.closePopup(),arrow:!1,position:"right-start",interactive:!0,tooltipTheme:"light",html:a.createElement(s.ThemeProvider,{theme:i},a.createElement(Bn,{role:"dialog",ariaModal:!0,tabIndex:0,context:o,closePopover:this.toggle}))},a.createElement(E.c,{id:"review-spot-".concat(p),role:"button",tabIndex:0,onClick:this.toggle,onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||this.toggle(e)},isActive:t,hasCounter:!!m,isDisplayForHint:this.state.isShownHint,title:Object(c.a)(m?"[view comments]":"[add comment]")},a.createElement(x.a,{src:zn.a}),!!m&&a.createElement(E.a,{fontSize:this.getFontSize(m)},m)))))}}Kn.defaultProps={isVoiceOver:!1};var Fn=Object(s.withTheme)(Object(d.b)((function(e,t){return{numberOfComments:b(e,t.context).filter(e=>!(null===e||void 0===e?void 0:e.isDeleted)&&!(null===e||void 0===e?void 0:e.isResolved)).length,reviewCommentReply:Object(g.a)(e)}}),(function(e){return{moduleActions:Object(v.b)(h,e)}}))(Kn));n.d(t,"default",(function(){return Fn}))}}]);